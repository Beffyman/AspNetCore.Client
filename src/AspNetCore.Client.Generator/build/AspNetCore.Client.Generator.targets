<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<Target Name="AspNetCoreClientGeneratorReflectionTarget"
			AfterTargets="Build"
			Condition="'$(GenerateClients)' == 'true' And '$(UseReflection) == 'true'">

		<Message Importance="high" Text="AspNetCore.Client.Generator:Reflection~ Target Project: $(MSBuildProjectDirectory)"/>

		<AspNetCore.Client.Generator.GeneratorTask CurrentDirectory="$(MSBuildProjectDirectory)"
													RouteToServiceProjectFolder="$(RouteToServiceProjectFolder)"
													ClientInterfaceName="$(ClientInterfaceName)"
													UseValueTask="$(UseValueTask)"
													UseInternalClients="$(UseInternalClients)"
													UseReflection ="$(UseReflection)"
													ReflectionAssemblyName="$(ReflectionAssemblyName)"
													ClientNamespace="$(ClientNamespace)"
													AllowedNamespaces="$(AllowedNamespaces)"
													ExcludedNamespaces="$(ExcludedNamespaces)"/>

		<ItemGroup>
			<Compile Include="**/*$(DefaultLanguageSourceExtension)"
					Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder);$(BaseIntermediateOutputPath)**;$(BaseOutputPath)**;@(Compile)" />
		</ItemGroup>
	</Target>

	<Target Name="AspNetCoreClientGeneratorRoslynTarget"
			BeforeTargets="CoreCompile"
			Condition="'$(GenerateClients)' == 'true' And '$(UseReflection) == 'false'">

		<Message Importance="high" Text="AspNetCore.Client.Generator:Roslyn~ Target Project: $(MSBuildProjectDirectory)"/>

		<AspNetCore.Client.Generator.GeneratorTask CurrentDirectory="$(MSBuildProjectDirectory)"
													RouteToServiceProjectFolder="$(RouteToServiceProjectFolder)"
													ClientInterfaceName="$(ClientInterfaceName)"
													UseValueTask="$(UseValueTask)"
													UseInternalClients="$(UseInternalClients)"
													UseReflection ="$(UseReflection)"
													ReflectionAssemblyName="$(ReflectionAssemblyName)"
													ClientNamespace="$(ClientNamespace)"
													AllowedNamespaces="$(AllowedNamespaces)"
													ExcludedNamespaces="$(ExcludedNamespaces)"/>

		<ItemGroup>
			<Compile Include="**/*$(DefaultLanguageSourceExtension)"
					Exclude="$(DefaultItemExcludes);$(DefaultExcludesInProjectFolder);$(BaseIntermediateOutputPath)**;$(BaseOutputPath)**;@(Compile)" />
		</ItemGroup>
	</Target>
</Project>